# Step 2: Create Example 2

[^ Notes](./00-notes.md)

The second example generator investigates different input types, and uses
handlebars in a more sophisticated way. It also outputs more than one file.

## Start creating the second example generator

Create another `plop.setGenerator()` call, in plopfile.js in the top-level.

The `force: true` property is handy, because we will be re-running this example
several times while creating it, and giving it the same heading every time avoids
building up masses of generated files.

See <https://plopjs.com/documentation/#add> for more of Plop‚Äôs `add` properties.

```js
...
    plop.setGenerator('example-2', {
        description: 'Second example generator',
        prompts: [
            {
                type: 'input',
                name: 'heading',
                message: 'Please provide a heading',
            },
            {
                type: 'input',
                name: 'description',
                message: 'Please provide a short description',
                default: 'Generated by example-2',
            },
        ],
        actions: [
            {
                type: 'add',
                path: 'example-output/example-2-{{heading}}/index.html',
                templateFile: 'example-templates/example-2/html.hbs',
                force: true, // overwrite file if it exists
            },
        ],
    });
...
```

Create example-templates/example-2/html.hbs:

```hbs
<!DOCTYPE html>
<html lang="{{lang}}">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{heading}}</title>
    <meta name="description" content="{{description}}">
    <link href="./style.css" rel="stylesheet">
</head>
<body>
    <h1>{{heading}}</h1>
    <p>{{description}}</p>
    <pre>Loading...</pre>
    <script src="./script.js"></script>
</body>
</html>
```

Check that it works using `npm run`:

```sh
npm run plop example-2
# > tryout-plop@0.0.1 plop
# > plop example-2
# ? Please provide a heading
ok
# ? Please provide a short description (Generated by example-2)
Tudo bem
# ‚úî  ++ /example-output/example-2-ok/index.html
open example-output/example-2-ok/index.html
```

Your default browser should open, showing the unstyled headline ‚Äúok‚Äù.

## Add the `lang` prompt

Currently example-output/example-2-ok/index.html is invalid HTML, because of the
`<html lang="">`. Example 2 should offer a selection of common language codes,
and default to `"en"` (for international English).

An overview of `inquirer` prompt types is available at:
<https://github.com/SBoudrias/Inquirer.js/blob/main/packages/inquirer/README.md#prompt-types>

Documentation for `list` and `rawList` is available at:
<https://github.com/SBoudrias/Inquirer.js/blob/main/packages/rawlist/README.md>

```js
...
    plop.setGenerator('example-2', {
        description: 'Second example generator',
        prompts: [
            {
                type: 'list',
                name: 'lang',
                message: 'Please provide a language code',
                choices: [
                    { name: 'English', value: 'en' },
                    { name: 'British English', value: 'en-GB' },
                    { name: 'US English', value: 'en-US' },
                    { name: 'Arabic', value: 'ar' },
                    { name: 'Spanish', value: 'es' },
                    { name: 'French', value: 'fr' },
                    { name: 'Portuguese', value: 'pt' },
                    { name: 'Chinese', value: 'zh' },
                ],
            },
            {
                type: 'input',
                name: 'heading',
                message: 'Please provide a heading'
            },
            ...
        ],
...
```

Check that it works using `npm run`:

```sh
npm run plop example-2
# > tryout-plop@0.0.1 plop
# > plop example-2
# ? Please provide a language code (Use arrow keys)
# ‚ùØ English 
#   British English 
#   US English 
#   Arabic 
#   Spanish 
#   French 
#   Portuguese 
# (Move up and down to reveal more choices)
Portuguese
# ? Please provide a heading
ok
# ? Please provide a short description (Generated by example-2)
Tudo bem
# ‚úî  ++ /example-output/example-2-ok/index.html
```

You should see`<html lang="pt">` in the generated index.html file.

## Ensure filenames are kebab-case

Currently if a user enters a `heading` like `"My Doc /.."`, then the files will
be written to an unexpected place, and the filename will contain spaces. It
would be better to convert the `heading` to [kebab case.](
https://developer.mozilla.org/en-US/docs/Glossary/Kebab_case)

Plop comes with some built-in
[case-modifier helpers,](https://plopjs.com/documentation/#case-modifiers)
which are listed in the node_modules/node-plop/src/baked-in-helpers.js script.

These built-in helpers are made available to Plop‚Äôs handlebars instance, so can
be used immediately in plopfile.js:

```js
...
        actions: [
            {
                type: 'add',
                path: 'example-output/example-2-{{kebabCase heading}}/index.html',
                ...
            },
        ],
...
```

...and also in the example-templates/example-2/html.hbs template file:

```hbs
...
<body>
    <code>{{kebabCase heading}}</code>
    <h1>{{heading}}</h1>
...
```

Check that it works again:

```sh
npm run plop example-2
# > tryout-plop@0.0.1 plop
# > plop example-2
# ? Please provide a language code (Use arrow keys)
English 
# ? Please provide a heading
Foo /.. Bar üòä
# ? Please provide a short description (Generated by example-2)
Using the kebabCase helper
# ‚úî  ++ /example-output/example-2-foo-bar/index.html
open example-output/example-2-foo-bar/index.html
```

Your default browser should open, showing:

```
foo-bar
Foo /.. Bar üòä
Using the kebabCase helper
Loading...
```

It's worth adding the `kebabCase` helper to example-1‚Äôs `path`, too.

## Create the CSS and JS files

These both have a commented line at the top, showing their generated path:

Create the example-templates/example-2/script.hbs JavaScript file:

```hbs
// example-2-{{kebabCase heading}}/script.js

document.querySelector('pre').innerHTML = 123;
```

And create the example-templates/example-2/style.hbs CSS file:

```hbs
/* example-2-{{kebabCase heading}}/style.css */

body {
    background: #003;
    color: #ddf;
    font: 18px/1.5 Arial, sans-serif;
}
```

And in plopfile.js tell the second example‚Äôs `actions` array how to generate them:

```mjs
export default function (plop) {
...
        actions: [
            {
                type: 'add',
                path: 'example-output/example-2-{{kebabCase heading}}/index.html',
                templateFile: 'example-templates/example-2/html.hbs',
                force: true, // overwrite file if it exists
            },
            {
                type: 'add',
                path: 'example-output/example-2-{{kebabCase heading}}/script.js',
                templateFile: 'example-templates/example-2/script.hbs',
                force: true,
            },
            {
                type: 'add',
                path: 'example-output/example-2-{{kebabCase heading}}/style.css',
                templateFile: 'example-templates/example-2/style.hbs',
                force: true,
            },
        ],
...
};
```

Check that everything‚Äôs working (bypassing the `heading` prompt, in this case):

```sh
npm run plop example-2 _ "All Working..."
# > tryout-plop@0.0.1 plop
# > plop example-2 _ All Working...
# ? Please provide a language code (Use arrow keys)
English 
# ? Please provide a short description (Generated by example-2)
Generated by example-2
# ‚úî  ++ /example-output/example-2-all-working/index.html
# ‚úî  ++ /example-output/example-2-all-working/script.js
# ‚úî  ++ /example-output/example-2-all-working/style.css
open example-output/example-2-all-working/index.html
```

Your default browser should show a styled page:

```
all-working
All Working...
Generated by example-2
123
```

## Check that invalid options are being rejected

```sh
npm run plop example-2 Nope
# > tryout-plop@0.0.1 plop
# > plop example-2 Nope
# [ERROR] The "lang" prompt did not recognize "Nope" as a valid list value (ERROR: invalid choice)
```
